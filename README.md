# Sport fields booking manager

In my company, several of us practice a collective sport during lunch break.
Oragnizing the sessions is always a problem because we do not have a tool to share information and sign up as a participant. Sometimes it is a poll, sometimes a long serie of email, and at the end, we never know if there are enough of us to play or if there are too many of us and in that situation, who are the people who won't be able to play?

I decided as a POC to propose a tool that will try to manage this.

## Features

The tool will manage booking for sports fields.

The main flow is as follows
* An administrator will create a session by specifying :
    - A sport
    - Maximum player number
    - Minimum player number
    - The session' planed date and hour
    - A duration
    - An expiration date (how many time before the expected date, the session will be canceled)
* After a player signing in, he will have the list of all sessions ordered by date
* He will signing up for the sessions he is interesting in
* Each time a new player sign up, a notification will be send to all the session' players.
* When the session reach the minimum player number, a notification will be send to all the players to confirm the session.
* If a session is under the minimum player number at the expiration date, a notification will be send to the registered players to inform them.
* If the registered players number exceed the maximum player number, each extra player receive a notification to inform him that he is on a wait list.
* If the registered players number is a multiple of the minimum player number, the software will automatically create new sessions.
* A player can cancel his registration, in this case a notification will be send to all other participants

## Backend API

The repository contains an ASP.NET Core Web API that exposes the core booking features through a REST interface. The implementation is located in `src/SportFieldsManager.Api` and relies on an in-memory data store that can later be replaced by a persistent database.

### Getting started

1. Install the [.NET 8 SDK](https://dotnet.microsoft.com/en-us/download).
2. Restore the dependencies and run the API:
   ```bash
   dotnet restore
   dotnet run --project src/SportFieldsManager.Api
   ```
3. Swagger UI is available at `https://localhost:5001/swagger` once the application is running.

### Main endpoints

| Method | Endpoint | Description |
| ------ | -------- | ----------- |
| `GET` | `/api/fields` | List all sport fields. |
| `POST` | `/api/fields` | Create a new field. |
| `GET` | `/api/timeslots` | List time slots (optionally filtered by field). |
| `POST` | `/api/timeslots` | Create a time slot for a field. |
| `POST` | `/api/timeslots/{id}/registrations` | Register a user on a time slot. |
| `DELETE` | `/api/timeslots/{id}/registrations/{userId}` | Cancel a user's registration. |
| `GET` | `/api/users` | List registered users. |
| `POST` | `/api/users` | Create a user and define his sports interests. |
| `GET` | `/api/notifications` | Inspect reminder emails generated by the background service. |

The API automatically handles wait lists when a time slot capacity is reached. A background service checks upcoming sessions every 12 hours and sends reminder emails when the minimum number of participants has not been reached three days before the session.

You can start building web, desktop or mobile clients by consuming these endpoints.
